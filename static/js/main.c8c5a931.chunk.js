(this["webpackJsonpconquer-covid"]=this["webpackJsonpconquer-covid"]||[]).push([[0],{31:function(e,t,n){e.exports=n(46)},36:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),a=n(26),r=n.n(a),c=(n(36),n(9)),s=n(51),u=n(56),l=n(52),d=n(54),h=n(27),f=n(30),m=n(15),p=n(28),g=n(23),v=(n(44),n(29)),w=n(53),E=n(48),x=n(49),b=n(50),y=n(55),k=n(5),P=new m.Chance,j=function(){return{infected:!1,id:Object(y.a)(),position:{x:0,y:0},name:P.name()}},S=function e(t,n){var i=this;Object(v.a)(this,e),this.population=void 0,this.size=void 0,this.engine=void 0,this.addPerson=function(e){var t=i.population,n=i.engine,o=i.size;t[e.id]=e;var a=k.Bodies.circle(P.integer({min:0,max:o.width}),P.integer({min:0,max:o.width}),5,{label:e.id});k.World.add(n.world,a)},this.removePerson=function(e){var t=i.population,n=i.engine;delete t[e];var o=w.a(E.a("label",e),n.world.bodies);o&&k.World.remove(n.world,o)},this.getPeople=function(){return x.a(i.population)},this.start=function(){var e=i.engine,t=i.population;k.Engine.run(e),k.Events.on(e,"afterUpdate",(function(){i.syncPopulationPosition()})),k.Events.on(e,"collisionStart",(function(e){e.pairs.forEach((function(e){var n=e.bodyA,i=e.bodyB,o=t[n.label],a=t[i.label];a&&o&&(o.infected=a.infected=o.infected||a.infected)}))}))},this.introduceEntropy=function(){var e=i.engine,t=i.size,n=P.pickone(e.world.bodies);n&&(n.isStatic||k.Body.applyForce(n,{x:P.integer({min:0,max:t.width}),y:P.integer({min:0,max:t.height})},{x:P.floating({min:-1e-4,max:1e-4}),y:P.floating({min:-1e-4,max:1e-4})}))},this.toData=function(){return{population:i.population,size:i.size}},this.syncPopulationPosition=function(){var e=i.engine,t=i.population;b.a((function(e){if(e.label){var n=t[e.label];n&&(n.position=e.position)}}),e.world.bodies)},this.setupEngine=function(){var e=i.size,t=k.Engine.create();return t.world.gravity.y=0,k.World.add(t.world,[k.Bodies.rectangle(e.width/2,-500,e.width,1e3,{isStatic:!0}),k.Bodies.rectangle(e.width+500,e.height/2,1e3,e.height,{isStatic:!0}),k.Bodies.rectangle(e.width/2,e.height+500,e.width,1e3,{isStatic:!0}),k.Bodies.rectangle(-500,e.height/2,1e3,e.height,{isStatic:!0})]),t},this.size=n,this.engine=this.setupEngine(),this.population={},b.a(this.addPerson,t),this.start(),t.forEach(this.addPerson)},B=function(e){var t=o.a.useState((function(){return e})),n=Object(c.a)(t,1)[0];o.a.useEffect((function(){var e=!1;return requestAnimationFrame((function t(){e||(n(),requestAnimationFrame(t))})),function(){e=!0}}),[n])},O=(n(45),function(e){var t=e.person;return o.a.createElement(o.a.Fragment,null,o.a.createElement("text",{className:"person-shape-face",x:t.position.x-5,y:t.position.y+5},t.infected?"\ud83e\udd2e":"\ud83d\ude42"),o.a.createElement("text",{className:"person-shape-name",x:t.position.x-5,y:t.position.y+10,lengthAdjust:"spacingAndGlyphs",textLength:"10"},t.name))}),z=function(e){var t=e.row,n=e.column,i=e.population,a=e.size;if(!i)return null;var r=(400-a.width)/2,c=(400-a.height)/2;return o.a.createElement("g",{style:{transform:"translate(".concat(400*n,"px, ").concat(400*t,"px)")}},o.a.createElement("rect",{width:400,height:400,fill:"transparent",stroke:"#cccccc"}),o.a.createElement("g",{style:{transform:"translate(".concat(r,"px, ").concat(c,"px)")}},o.a.createElement("rect",{width:a.width,height:a.height,fill:"transparent",stroke:"black"}),x.a(i).map((function(e){return o.a.createElement(O,{key:e.id,person:e})}))))},A=function(e){var t=e.columnCount,n=e.rooms,a=o.a.useState(n.map((function(e){return e.toData()}))),r=Object(c.a)(a,2),s=r[0],u=r[1];return Object(i.useEffect)((function(){return console.log("Town construction"),function(){return console.log("Town destruction")}}),[]),B((function(){u(n.map((function(e){return e.toData()})))})),o.a.createElement(o.a.Fragment,null,s.map((function(e,n){return o.a.createElement(z,Object.assign({key:n},e,{row:Math.floor(n/t),column:n%t}))})))},F=p,N=new m.Chance,W=Math.floor(3),q=function(){var e=o.a.useState(F().unix()),t=Object(c.a)(e,2),n=t[0],i=t[1],a=o.a.useState([]),r=Object(c.a)(a,2),m=r[0],p=r[1];return o.a.useEffect((function(){p(function(){var e=s.a(j,90);N.pickone(e).infected=!0;var t=u.a(10,e);return l.a((function(e){var t=N.integer({min:100,max:400});return new S(e,{height:t,width:t})}),t)}())}),[]),Object(g.a)((function(){i((function(e){return F.unix(e).add(10,"minutes").unix()}))}),1e3),Object(g.a)((function(){var e=N.pickone(m),t=N.pickone(m);if(!d.a(e.getPeople())){var n=N.pickone(e.getPeople());e.removePerson(n.id),t.addPerson(n),m.forEach((function(e){return e.introduceEntropy()}))}}),100),o.a.createElement("div",{className:"app"},o.a.createElement(h.a,null,(function(e){var t=e.width,n=e.height;return t&&n&&o.a.createElement(f.a,{width:t,height:n,tool:"pan",customToolbar:function(){return null},customMiniature:function(){return null}},o.a.createElement("svg",{className:"world",viewBox:"0 0 ".concat(1200," ").concat(400*W)},o.a.createElement(A,{columnCount:3,rooms:m})))})),o.a.createElement("h1",{className:"time"},F.unix(n).format()))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[31,1,2]]]);
//# sourceMappingURL=main.c8c5a931.chunk.js.map